{% extends "base.html" %}

{% block content %}

<div class="container-fluid">

<!--    <div class="row no-gutters">
        <div class="col-sm-12">
            <div style="height: 10px">
                <p></p>
            </div>
        </div>
    </div>
-->
    <div class="row no-gutters">
       <!-- <div class="col-sm-1">
            </div> -->
                <div class="col-sm-8 padding-0">
                    <div id="map"></div>
                </div>

                <div class="col-sm-3 padding-0">
                    <div class="col-sm-3 padding-0">
                        <div style="width: 230px; height: auto; background-color: white; border: 5px orange solid; border-radius: 6px">
                            <img src="{{url_for('static', filename='images/clock.png')}}" width="220px" />
                            <form action="/signUp" method="post" role="form" id="picker">
                            <input type="date" name="date">
                            <input type="time" name="time">
                            <button class="btn btn-sm btn-primary btn-block" type="button">Submit</button>
                            </form>
                        </div>

                        <div id="openweathermap-widget-12"></div>
                    </div>
                 <!-- <div class="col-sm-1"></div> -->
                </div>
    </div>
</div>

<script>
    window.myWidgetParam ? window.myWidgetParam : window.myWidgetParam = [];
    window.myWidgetParam.push({
        id: 12,
        cityid: '2964574',
        appid: '718d1e3d695907c31b9a4b710e8348f5',
        units: 'metric',
        containerid: 'openweathermap-widget-12',
    });
    (function() {
        var script = document.createElement('script');
        script.async = true;
        script.charset = "utf-8";
        script.src = "//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator.js";
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(script, s);
    })();
    $(document).ready(function() {
        $('#picker').dateTimePicker();
        $('#picker-no-time').dateTimePicker({
            showTime: false,
            dateFormat: 'DD/MM/YYYY'
        });
    })
</script>

    <script>
        function initMap() {
            var options = {
                zoom:13,
                center:{lat:53.345,lng:-6.268}
            }
            //Add map
            var map = new google.maps.Map(document.getElementById('map'),options);
            //Add marker function
            function addMarker(coords,address,available_bike_stands='Unknown',available_bikes='Unknown'){
                //Add marker with custom icon at specified point
                if (available_bikes=='Unknown') {
            var marker = new google.maps.Marker({
                position:coords,
                map:map,
                icon:'./static/images/red_markerC.png'
            });
                } else if (available_bikes<10) {
                    var marker = new google.maps.Marker({
                position:coords,
                map:map,
                icon:'./static/images/red_markerC.png'
            });
                } else if (available_bikes<20) {
                    var marker = new google.maps.Marker({
                position:coords,
                map:map,
                icon:'./static/images/orange_markerC.png'
            }); 
                } else {
                    var marker = new google.maps.Marker({
                position:coords,
                map:map,
                icon:'./static/images/green_markerC.png'
            });
                }
            //add listener to display window above marker
                var infoWindow = new google.maps.InfoWindow({
                content:'<h1>'+address+'</h1><br><p>Current number of bikestands:'+available_bike_stands+'</p><br><p>Current number of bikes:'+available_bikes+'</p>'
                });
            marker.addListener('click',function() {
                infoWindow.open(map, marker);
            });
            }
            {% for item in range(0,len) %}
            var position = {lat:{{lat[item]}},lng:{{lng[item]}}};

           var specific_address ="{{address[item]}}"; 
            var bikestands = "{{bikestands[item]}}";
           var available_bikes = "{{available_bikes[item]}}";
            
            addMarker(position,specific_address,bikestands,available_bikes);
            {% endfor %}
        }
    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAYZPR-bZ82RtqEpm2Zot3kMNaEZwxGKgM&callback=initMap"
    async defer></script>
{% endblock %}
